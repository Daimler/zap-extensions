[#th:block th:with="sarifSupport=${helper.createSupport('sarif',reportData)}"]{
   "runs": [
      {
         "results": [ [[#th:block th:each="sarifResult, sarifResultState: ${sarifSupport.results}"][#th:block th:if="${! sarifResultState.first}"],[/th:block]
            {
               "level": [[${sarifResult.level.value}]],
               "locations": [[#th:block th:each="sarifLocation, sarifLocationState: ${sarifResult.locations}"][#th:block th:if="${! sarifLocationState.first}"],[/th:block]
                  {
                     "physicalLocation": {
                        "artifactLocation": {
                           "uri": [[${sarifLocation.physicalLocation.artifactLocation.uri}]]
                        }
                     },
                     "properties": {
                         "attack": [[${sarifLocation.properties.attack}]],
                         "evidence": [[${sarifLocation.properties.evidence}]]
                     }
                  }
               ][/th:block]],
               "message": {
                  "text": [[${sarifResult.message.text}]]
               },
               "ruleId": [[${sarifResult.ruleId}]],
                    "webRequest": {[#th:block th:with="webRequest=${sarifResult.webRequest}"]
                        "protocol": [[${webRequest.protocol}]],
                        "version": [[${webRequest.version}]],
                        "target": [[${webRequest.target}]],
                        "method": [[${webRequest.method}]],
                        "headers": {[#th:block th:each="header, headerState: ${webRequest.headers}"]
                            [[${header.key}]] : [[${header.value}]][#th:block th:if="${! headerState.first}"],[/th:block]
                        [/th:block]},
                        "body": {
                            "text": [[${webRequest.body.text}]],
                            "binary": [[${webRequest.body.binary}]]
                        }
                    }[/th:block],
                    "webResponse": {[#th:block th:with="webResponse=${sarifResult.webResponse}"]
                        "statusCode": [[${webResponse.statusCode}]],
                        "reasonPhrase": [[${webResponse.reasonPhrase}]],
                        "protocol": [[${webResponse.protocol}]],
                        "version": [[${webResponse.version}]],
                        "target": [[${webResponse.target}]],
                        "method": [[${webResponse.method}]],
                        "headers": {[#th:block th:each="header, headerState: ${webResponse.headers}"]
                            [[${header.key}]] : [[${header.value}]][#th:block th:if="${! headerState.first}"],[/th:block]
                        [/th:block]},
                        "body": {
                            "text": [[${webResponse.body.text}]],
                            "binary": [[${webResponse.body.binary}]]
                        },
                        "noResponseReceived": [[${webResponse.noResponseReceived}]]
                    }[/th:block]
            }
         [/th:block]],
         "taxonomies": [
            {
               "downloadUri": "https://cwe.mitre.org/data/xml/cwec_v4.4.xml.zip",
               "guid": "f2856fc0-85b7-373f-83e7-6f8582243547",
               "informationUri": "https://cwe.mitre.org/data/published/cwe_v4.4.pdf/",
               "isComprehensive": true,
               "language": "en",
               "minimumRequiredLocalizedDataSemanticVersion": "4.4",
               "name": "CWE",
               "organization": "MITRE",
               "releaseDateUtc": "2021-03-15",
               "shortDescription": {
                  "text": "The MITRE Common Weakness Enumeration"
               },
               "taxa": [
                  {
                     "guid": "1a37bf66-7c5a-3aa0-94bb-ffae58a9e01c",
                     "id": "79"
                  }
               ],
               "version": "4.4"
            }
         ],
         "tool": {
            "driver": {
               "guid": "4d841334-0141-4e13-bdd0-53087266ebcd",
               "informationUri": "https://www.zaproxy.org/",
               "name": "OWASP ZAP",
               "rules": [ [#th:block th:each="sarifRule, sarifRuleState: ${sarifSupport.rules}"][#th:block th:if="${! sarifRuleState.first}"],[/th:block]
                  {
                     "id": "[(${sarifRule.id})]",
                     "defaultConfiguration": {
                        "level": "error"
                     },
                     "fullDescription": {
                        "text": "[(${sarifRule.fullDescription})]"
                     },
                     "name": "[(${sarifRule.name})]",
                     "relationships": [ [#th:block th:each="relationShip, relationShipState: ${sarifRule.relationShips}"][#th:block th:if="${! relationShipState.first}"],[/th:block]
                        {
                           "kinds": [
                              "superset"
                           ],
                           "target": {
                              "guid": "6bd55435-166c-3594-bc06-5e0dea916067",
                              "id": "[(${relationShip.target.id})]",
                              "toolComponent": {
                                 "guid": "f2856fc0-85b7-373f-83e7-6f8582243547",
                                 "name": "CWE"
                              }
                           }
                        }
                        [/th:block]
                     ],
                     "shortDescription": {
                        "text": "[(${sarifRule.shortDescription})]"
                     }
                  }
                  [/th:block]
               ],
               "semanticVersion": [[${zapVersion}]],
               "supportedTaxonomies": [
                  {
                     "guid": "f2856fc0-85b7-373f-83e7-6f8582243547",
                     "name": "CWE"
                  }
               ],
               "version": [[${zapVersion}]]
            }
         }
      }
   ],
   "$schema": "https://raw.githubusercontent.com/oasis-tcs/sarif-spec/master/Schemata/sarif-schema-2.1.0.json",
   "version": "2.1.0"
}[/th:block]
